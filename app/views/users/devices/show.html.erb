<% content_for :outside_container do %>
  <%= render 'users/shared/device_show' %>

  <div class="bottom-panel valign-wrapper">
    <div class="buttons">
      <%= link_to("Delete history", user_device_checkins_path(current_user.url_id, @presenter.device.id), { method: :delete, class: "btn red white-text", data: { confirm: 'Delete all checkins for this device?' } })%>
      <%= link_to("Delete device", user_device_path(current_user.url_id, @presenter.device), { method: :delete, class: "btn red white-text", data: { confirm: 'Are you sure?' } })%>
      <a id="checkinNow" class="btn green white-text" href="#" data-turbolinks="false">Checkin now</a>
      <a id="checkinFoggedNow" class="btn green white-text" href="#" data-turbolinks="false">Checkin now (fogged)</a>
    </div>
  </div>

  <ul id='filters' class='date-select collapsible'>
    <li>
      <div class='collapsible-header'>Select a date range</div>
      <div class='collapsible-body'>
        <%= form_for @presenter.device, url: user_device_path(current_user.url_id, @presenter.device), class: "form-group", method: :get do |f| %>
          <%= f.label 'From' %>
          <%= text_field_tag(:from, humanize_date(@presenter.date_range[:from]), class: "datepick", id: "input_from", required: true) %>
          <%= f.label 'to' %>
          <%= text_field_tag(:to, humanize_date(@presenter.date_range[:to]), class: "datepick", id: "input_to", required: true) %>
          <%= f.label 'Or' %>
          <div class='date-filter-presets'>
            <%= devices_range_filter('LAST 24', 1.day.ago) %>|
            <%= devices_range_filter('LAST WEEK', 1.week.ago) %>|
            <%= devices_range_filter('LAST MONTH', 1.month.ago) %>|
            <%= devices_range_filter('LAST YEAR', 1.year.ago) %>
          </div>
          <%= f.submit("Apply", class: "form-control btn btn-default") %>
          <%= link_to("Clear", user_device_path(current_user.url_id, @presenter.device) , { method: :get, class: "btn-flat right" })%>
        <% end %>
      </div>
    </li>
  </ul>

  <!-- templates -->
  <script type="x-tmpl-mustache" id="markerPopupTmpl">
    <h3>ID: {{ id }}  <i class="tooltipped" data-tooltip="Latitude/longitude have been changed from original values">{{ edited }}</i></h3>
    <ul>
      <li id="localTime">{{ created_at }}</li>
      <h3 class="lined"><span class="lined-pad">Coordinates</span></h3>
      <li class="ta-center">{{ &inlineCoords }}</li>
      <h3 class="lined"><span class="lined-pad">Address</span></h3>
      <li class="address">{{ address }}</li>
      {{ &foggedAddress }}
      <li>{{ &foggle }} {{ &deletebutton }}</li>
    </ul>
  </script>

  <script type="x-tmpl-mustache" id="createCheckinTmpl">
    <ul>
      <li>Latitude: {{ lat }}</li>
      <li>Longitude {{ lng }}</li>
      <li>{{ &checkinLink }}</li>
    </ul>
  </script>

<% end %>
