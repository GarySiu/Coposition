<div id='gonvariables'><%= Gon::Base.render_data %></div>
<h1>Your devices</h1>
<div class="row">
  <div class="center">
    <%= link_to(new_user_device_path, class: "btn-floating btn-large waves-effect waves-light primary-color") do %>
      <i class="material-icons">add</i>
    <% end %>
  </div>
</div>
<div id='calendar'></div>
<div>
  <% @presenter.devices.each do |device| %>
    <%= render device %>
  <% end %>
</div>

<script>
  $('.modal-trigger').leanModal({
    ready: function() {
      var $list = $(this.ready.caller.arguments[0][0]).find('ul');
      if($list.children().length===1) {
        var device_id = $list.data().device;
        var originator = { from: 'devices' }
        $list.append(`<div class="progress"><div class="indeterminate"></div></div>`);
        $.get({
          url: window.location.href+"/"+device_id+"/permissions",
          data: originator,
          dataType: "script"
        });
      }
    }
  });
</script>
